(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
var makeUrl=require("./util/makeurl"),PATH_TOKEN="oauth/token",PATH_AUTHORIZE="oauth/authorize",KEY_PRIVATE_TOKEN="emPrivateToken",KEY_REFRESH_TOKEN="emRefreshToken",KEY_ACCESS_TOKEN="emAccessToken",KEY_SUBACCOUNT="emSubaccount";module.exports=function(e,t,n,r,o){function i(){return E(KEY_PRIVATE_TOKEN)}function c(){return E(KEY_REFRESH_TOKEN)}function u(){return E(KEY_ACCESS_TOKEN)}function a(){return E(KEY_SUBACCOUNT)}function s(e){h(e,KEY_PRIVATE_TOKEN)}function _(e){h(e,KEY_SUBACCOUNT)}function f(e){h(e,KEY_REFRESH_TOKEN),l(null)}function l(e){null!==e&&(e.expires_at=Date.now()+1e3*e.expires_in),h(e,KEY_ACCESS_TOKEN)}function E(t){var n=e.localStorage.getItem(t);return!n||"{"!=n.charAt(0)&&"["!=n.charAt(0)?n:JSON.parse(n)}function h(t,n){if(t){var r=typeof t;"string"!==r&&"number"!==r&&(t=JSON.stringify(t)),e.localStorage.setItem(n,t)}else e.localStorage.removeItem(n)}function d(){return null!==i()||null!==c()}function T(e){return n(function(t,n){var o=i(),u=a();if(u&&!e.preventSubaccount&&(e.headers=e.headers||{},e.headers["X-Subaccount"]=u),o)return e.headers=e.headers||{},e.headers.Authorization="OAuth "+o,void t(e);if(r.disabled)return void t(e);var s=c();return s?void A(s).then(function(n){e.headers=e.headers||{},e.headers.Authorization="Bearer "+n.access_token,t(e)},function(){n()}):void n()})}function A(e){return n(function(t,n){var r=u();S(r)?t(r):(v.push(function(e){e?t(e):n()}),k||(k=!0,K(e).then(function(e){var t=e.data;l(t),k=!1,v.forEach(function(e){e(u())}),v=[]},function(){l(null),k=!1,v.forEach(function(e){e(null)}),v=[]})))})}function S(e){return e&&e.expires_at>Date.now()}function K(e){return t.post(makeUrl([o,PATH_TOKEN]),{client_id:r.clientId,client_secret:r.clientSecret,grant_type:"refresh_token",scope:r.scope||"basic",refresh_token:e})}function p(){var e={client_secret:r.clientSecret,client_id:r.clientId,redirect_uri:r.redirectUri,grant_type:"authorization_code",response_type:"code",state:"emAuth",scope:r.scope||"basic"};return makeUrl([o,PATH_AUTHORIZE],e)}function O(e){return t.post(makeUrl([o,PATH_TOKEN]),{grant_type:"authorization_code",code:e,client_id:r.clientId,client_secret:r.clientSecret,state:"emAuth",scope:r.scope||"basic",redirect_uri:r.redirectUri}).then(function(e){var t=e.data;f(t.refresh_token),l(t)})}var v=[],k=!1;return{getPrivateToken:i,setPrivateToken:s,getRefreshToken:c,setRefreshToken:f,getSubaccount:a,setSubaccount:_,isAuthenticated:d,authorizeUrl:p,handleAuthCode:O,authorize:T}};


},{"./util/makeurl":41}],2:[function(require,module,exports){
function _zeroPaddedString(e){return null===e||void 0===e?"":(10>e?"0":"")+e}function _periodFormat(e,t,r,n){return null!==t&&void 0!==t&&t++,_zeroPaddedString(e)+_zeroPaddedString(t)+_zeroPaddedString(r)+_zeroPaddedString(n)}function periodsFormat(e,t){return angular.isArray(e)?e.map(t).join("-"):t(e)}function getYearPeriod(e){return periodsFormat(e,function(e){return _periodFormat(e.getFullYear())})}function getMonthPeriod(e){return periodsFormat(e,function(e){return _periodFormat(e.getFullYear(),e.getMonth())})}function getDayPeriod(e){return periodsFormat(e,function(e){return _periodFormat(e.getFullYear(),e.getMonth(),e.getDate())})}function getHourPeriod(e){return periodsFormat(e,function(e){return _periodFormat(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours())})}function getPeriod(e,t,r){var n=angular.isArray(e),o=n&&e.length>1;if(n&&0===e.length||null===e||void 0===e)return null;if("month"===t)return o||r?getMonthPeriod(e):getYearPeriod(e);if("day"===t)return o||r?getDayPeriod(e):getMonthPeriod(e);if("week"===t&&!o){var a=n?e[0]:e,i=new Date(a.getTime());return i.setDate(i.getDate()+6),getDayPeriod([a,i])}return getDayPeriod(e)}function getDate(e){if("number"==typeof e&&(e=e.toString()),null===e||void 0===e||e.length<4)return null;for(var t=[parseInt(e.substr(0,4),10)],r=0,n=e.length;n>4+2*r;)t[r+1]=parseInt(e.substr(4+2*r,2)),r++;return new Date(t[0],t[1]?t[1]-1:0,t[2]||1,t[3]||0,t[4]||0,t[5]||0)}function daysInMonth(e){var t=new Date(e.getTime());return t.setMonth(t.getMonth()+1),t.setDate(0),t.getDate()}function parseISO(e){var t=Date.parse(e);if(!isNaN(t))return new Date(t);var r,n,o,a=e.slice(0,-5).split(/\D/).map(function(e){return parseInt(e,10)||0});return a[1]-=1,n=e.slice(-5),o=parseInt(n,10)/100,r=new Date(Date.UTC.apply(Date,a)),r.setHours(r.getHours()-o),r}module.exports={getDate:getDate,getHourPeriod:getHourPeriod,getDayPeriod:getDayPeriod,getMonthPeriod:getMonthPeriod,getPeriod:getPeriod,getYearPeriod:getYearPeriod,daysInMonth:daysInMonth,parseISO:parseISO,periodFromComponents:_periodFormat};


},{}],3:[function(require,module,exports){
module.exports=function(s,o,e,n,t,i,r,c,l,a,p,u,b,C,R,S,d,f,g,m,M,J,T,h,k,F,w,A,E,O,v,x,y,D,I){function L(o,e){o.then(function(o){e===!0?s.console.log("Response:\n",o):s.console.log("Response:\n",JSON.stringify(o,null,2))},function(o){s.console.log("Error:\n",o)})}L.Accounts=o,L.Apps=e,L.Clients=n,L.ComplaintCases=t,L.Complaints=i,L.CalculatedMetrics=r,L.ConsumptionStats=c,L.Consumptions=l,L.EdielJobs=a,L.Feeds=p,L.FileJobs=u,L.FtpConnections=b,L.Invitations=C,L.LoginTokens=R,L.Me=S,L.Meters=d,L.MeterStats=f,L.MetricModels=g,L.Owners=m,L.Password=M,L.Readings=J,L.RefreshTokens=T,L.Reports=h,L.RobotJobs=k,L.RobotStats=F,L.Robots=w,L.Scrapers=A,L.ScraperTests=E,L.Subaccounts=O,L.Subscribers=v,L.Tokens=x,L.DateUtil=y,L.api=D,L.auth=I,s.em=L};


},{}],4:[function(require,module,exports){
var makeUrl=require("./util/makeurl"),PATH_API_VERSION="api/2.0",EVENT_LOGIN_NEEDED="em:loginNeeded";module.exports=function(t,a,n,i,u){function d(n){return a(function(a,d){n.url=makeUrl([u,PATH_API_VERSION,n.url]),i.authorize(n).then(function(n){t(n).then(function(t){a(o(t))},function(t){401===t.status&&(i.getPrivateToken()?(i.setPrivateToken(null),e()):e()),d(t.data?t.data.errors:{})})},function(){e(),d({})})})}function e(){n.$broadcast(EVENT_LOGIN_NEEDED)}function o(t){return null==t.data.count||null==t.data.limit||null==t.data.skip?t.data.data:{data:t.data.data,pagination:{skip:t.data.skip,limit:t.data.limit,count:t.data.count,page:1+t.data.skip/t.data.limit,from:0===t.data.count?0:t.data.skip+1,to:t.data.skip+t.data.limit>t.data.count?t.data.count:t.data.skip+t.data.limit}}}return{request:d}};


},{"./util/makeurl":41}],5:[function(require,module,exports){
var MODULE_NAME="energimolnet",ngModule=angular.module(MODULE_NAME,[]);"object"==typeof module&&(module.exports=MODULE_NAME),ngModule.factory("emDateUtil",function(){return require("./date-util")}).factory("emAuth",["$window","$http","$q","authConfig","apiBaseUrl",require("./auth")]).factory("energimolnetAPI",["$http","$q","$rootScope","emAuth","apiBaseUrl",require("./energimolnet-api")]).factory("emResourceFactory",["energimolnetAPI",require("./resource-factory")]).factory("emAccounts",["emResourceFactory",require("./models/accounts")]).factory("emActivityStreams",["emResourceFactory",require("./models/activitystream")]).factory("emApps",["emResourceFactory",require("./models/apps")]).factory("emBillableMeters",["emResourceFactory",require("./models/billable-meters")]).factory("emCalculatedMetrics",["emResourceFactory",require("./models/calculated-metrics")]).factory("emClients",["emResourceFactory",require("./models/clients")]).factory("emComplaintCases",["emResourceFactory","energimolnetAPI",require("./models/complaint-cases")]).factory("emComplaints",["emResourceFactory",require("./models/complaints")]).factory("emConsumptionStats",["emResourceFactory",require("./models/consumption-stats")]).factory("emConsumptions",["emResourceFactory","energimolnetAPI",require("./models/consumptions")]).factory("emEdielJobs",["emResourceFactory",require("./models/ediel-jobs")]).factory("emFeeds",["emResourceFactory",require("./models/feeds")]).factory("emFileJobs",["emResourceFactory","energimolnetAPI",require("./models/file-jobs")]).factory("emFtpConnections",["emResourceFactory",require("./models/ftp-connections")]).factory("emInvitations",["emResourceFactory",require("./models/invitations")]).factory("emLoginTokens",["emResourceFactory",require("./models/logintokens")]).factory("emMe",["emResourceFactory",require("./models/me")]).factory("emMeters",["emResourceFactory","energimolnetAPI",require("./models/meters")]).factory("emMeterActivities",["emResourceFactory",require("./models/meter-activities")]).factory("emMeterStats",["emResourceFactory",require("./models/meter-stats")]).factory("emMetricModels",["emResourceFactory",require("./models/metric-models")]).factory("emOwners",["emResourceFactory",require("./models/owners")]).factory("emPassword",["emResourceFactory",require("./models/password")]).factory("emReadings",["emResourceFactory","energimolnetAPI",require("./models/readings")]).factory("emEdielJobs",["emResourceFactory",require("./models/ediel-jobs")]).factory("emRefreshTokens",["emResourceFactory",require("./models/refreshtokens")]).factory("emReports",["emResourceFactory",require("./models/reports")]).factory("emRobotJobs",["emResourceFactory",require("./models/robot-jobs")]).factory("emRobotStats",["emResourceFactory",require("./models/robot-stats")]).factory("emRobots",["emResourceFactory","energimolnetAPI",require("./models/robots")]).factory("emScrapers",["emResourceFactory",require("./models/scrapers")]).factory("emScraperTests",["emResourceFactory",require("./models/scraper-tests.js")]).factory("emSubaccounts",["emResourceFactory",require("./models/subaccounts")]).factory("emSubscribers",["emResourceFactory","energimolnetAPI",require("./models/subscribers")]).factory("emTokens",["emResourceFactory",require("./models/tokens")]).run(["$window","emAccounts","emApps","emClients","emComplaintCases","emComplaints","emCalculatedMetrics","emConsumptionStats","emConsumptions","emEdielJobs","emFeeds","emFileJobs","emFtpConnections","emInvitations","emLoginTokens","emMe","emMeters","emMeterStats","emMetricModels","emOwners","emPassword","emReadings","emRefreshTokens","emReports","emRobotJobs","emRobotStats","emRobots","emScrapers","emScraperTests","emSubaccounts","emSubscribers","emTokens","emDateUtil","energimolnetAPI","emAuth",require("./debug-util")]);
},{"./auth":1,"./date-util":2,"./debug-util":3,"./energimolnet-api":4,"./models/accounts":6,"./models/activitystream":7,"./models/apps":8,"./models/billable-meters":9,"./models/calculated-metrics":10,"./models/clients":11,"./models/complaint-cases":12,"./models/complaints":13,"./models/consumption-stats":14,"./models/consumptions":15,"./models/ediel-jobs":16,"./models/feeds":17,"./models/file-jobs":18,"./models/ftp-connections":19,"./models/invitations":20,"./models/logintokens":21,"./models/me":22,"./models/meter-activities":23,"./models/meter-stats":24,"./models/meters":25,"./models/metric-models":26,"./models/owners":27,"./models/password":28,"./models/readings":29,"./models/refreshtokens":30,"./models/reports":31,"./models/robot-jobs":32,"./models/robot-stats":33,"./models/robots":34,"./models/scraper-tests.js":35,"./models/scrapers":36,"./models/subaccounts":37,"./models/subscribers":38,"./models/tokens":39,"./resource-factory":40}],6:[function(require,module,exports){
module.exports=function(e){var t=e({"default":"/accounts",get:!0,query:!0,put:!0,post:!0,"delete":!0});return t.exists=e({"default":"/accounts/exists",get:!1,query:!0,put:!1,post:!1,"delete":!1}),t};


},{}],7:[function(require,module,exports){
module.exports=function(t){var e=t({"default":"/activityStream",get:!0,query:!0,put:!1,post:!1,"delete":!1});return e};


},{}],8:[function(require,module,exports){
module.exports=function(e){return e({forAccount:{"default":"apps",get:!0,query:!0,"delete":!0}})};


},{}],9:[function(require,module,exports){
module.exports=function(e){return e({forAccount:{"default":"billing_summary",get:!0,put:!1,post:!1,query:!0,"delete":!1}})};


},{}],10:[function(require,module,exports){
module.exports=function(e){return e({forMeter:{"default":"calculated_metrics",get:!0,put:!0,post:!0,query:!0,"delete":!0}})};


},{}],11:[function(require,module,exports){
module.exports=function(e){return e({"default":"/clients",get:!0,put:!0,post:!0,query:!0,"delete":!0,forAccount:{"default":"clients",get:!0,put:!0,post:!0,query:!0,"delete":!0}})};


},{}],12:[function(require,module,exports){
module.exports=function(e,t){var o=e({"default":"/complaint_cases",get:!0,query:!0,post:!0});return o.close=function(e){return t.request({url:"/complaint_cases/"+e+"/close",method:"PUT"})},o};


},{}],13:[function(require,module,exports){
module.exports=function(e){return e({"default":"/complaints",get:!0,query:!0,post:!0,"delete":!0})};


},{}],14:[function(require,module,exports){
module.exports=function(t){return t({"default":"/accounts/me/consumption_stats",get:!0,forAccount:{"default":"consumption_stats",get:!0}})};


},{}],15:[function(require,module,exports){
module.exports=function(n,r){var t=n({"default":"/consumptions",forAccount:{"default":"consumptions",put:!0}});return t.get=function(n,t,u,o){return o=o||["energy"],o=angular.isArray(o)?o:[o],u=angular.isArray(u)?u:[u],r.request({method:"GET",url:[this._config["default"],n,t,u.join("+")].join("/"),params:{metrics:o.join(",")}})},t};


},{}],16:[function(require,module,exports){
module.exports=function(e){return e({"default":"/ediel_jobs",get:!0,query:!0,put:!0,post:!0,"delete":!0})};


},{}],17:[function(require,module,exports){
module.exports=function(e){var t=e({"default":"/feeds",get:!0,query:!0,put:!0,post:!0,"delete":!0});return t};


},{}],18:[function(require,module,exports){
module.exports=function(e,r){var t=e({"default":"/file_jobs",get:!0,query:!0,put:!0,save:!0,"delete":!0});return t.reRun=function(e){return r.request({method:"PUT",url:"/file_jobs/"+e+"/release"})},t};


},{}],19:[function(require,module,exports){
module.exports=function(t){return t({forAccount:{"default":"ftp_connections",get:!0,query:!0,put:!0,post:!0,"delete":!0}})};


},{}],20:[function(require,module,exports){
module.exports=function(t){return t({"default":"/invitations",get:!0,query:!0,put:!0,post:!0,"delete":!0})};


},{}],21:[function(require,module,exports){
module.exports=function(e){return e({forAccount:{"default":"login_tokens",get:!1,put:!1,post:!0,query:!0,"delete":!0}})};


},{}],22:[function(require,module,exports){
module.exports=function(t){return t({"default":"/accounts/me",get:!0,put:!0})};


},{}],23:[function(require,module,exports){
module.exports=function(e){return e({forMeter:{"default":"activity",get:!1,put:!1,post:!1,query:!0,"delete":!1}})};


},{}],24:[function(require,module,exports){
module.exports=function(e){return e({"default":"/stats/meters",get:!1,query:!0,put:!1,post:!1,"delete":!1})};


},{}],25:[function(require,module,exports){
var PATH_ASSIGN="/meters/many/assign_to",PATH_SHARE="/meters/many/share_with",PATH_REVOKE="/meters/many/revoke";module.exports=function(e,r){function t(e){return function(t,n){for(var a=[],u=t.length,o=n.length,s=0;u>s;s++)for(var h=t[s],m=0;o>m;m++){var A=n[m];a.push({_id:h,holder:A})}return r.request({url:e,method:"POST",data:a})}}function n(e){return r.request({url:PATH_REVOKE,method:"PUT",data:e})}var a=e({"default":"/meters",get:!0,query:!0,put:!0,post:!0,"delete":!0,batch:!0});return a.assign=t(PATH_ASSIGN),a.share=t(PATH_SHARE),a.revoke=n,a};


},{}],26:[function(require,module,exports){
module.exports=function(e){return e({"default":"/metric_models",get:!0,query:!0,put:!0,post:!0,"delete":!0})};


},{}],27:[function(require,module,exports){
module.exports=function(e){return e({"default":"/owners",get:!0,query:!0})};


},{}],28:[function(require,module,exports){
module.exports=function(t){return t({"default":"/accounts/me/password",put:!0})};


},{}],29:[function(require,module,exports){
module.exports=function(r,e){var t=r({"default":"/readings"});return t.get=function(r,t,n,a){return a=a||["energy"],a=angular.isArray(a)?a:[a],n=angular.isArray(n)?n:[n],e.request({method:"GET",url:[this._config["default"],r,t,n.join("+")].join("/"),params:{metrics:a.join(",")}})},t.interpolate=function(r,t){return e.request({method:"POST",url:[this._config["default"],r,"interpolate"].join("/"),data:t})},t};


},{}],30:[function(require,module,exports){
module.exports=function(e){return e({"default":"/refreshtokens",query:!0})};


},{}],31:[function(require,module,exports){
module.exports=function(t){return t({"default":"/reports",post:!0})};


},{}],32:[function(require,module,exports){
module.exports=function(e){return e({"default":"/robot_jobs",get:!0,query:!0,put:!0,post:!0,"delete":!0})};


},{}],33:[function(require,module,exports){
module.exports=function(t){return t({"default":"/stats/robots",get:!1,query:!0,put:!1,post:!1,"delete":!1})};


},{}],34:[function(require,module,exports){
var makeUrl=require("../util/makeurl");module.exports=function(e,r){var t=e({"default":"/robots",get:!0,query:!0,put:!0,post:!0});return t.run=function(e){return r.request({url:[this._config["default"],e,"run"].join("/"),method:"POST"})},t["delete"]=function(e,t){var u=makeUrl([this._config["default"],e]);return t&&(u+="/trash_meters"),r.request({method:"DELETE",url:u})},t};


},{"../util/makeurl":41}],35:[function(require,module,exports){
module.exports=function(e){return e({"default":"/scraper_tests",get:!0,query:!0})};


},{}],36:[function(require,module,exports){
module.exports=function(e){return e({"default":"/scrapers",get:!0,query:!0})};


},{}],37:[function(require,module,exports){
module.exports=function(t){return t({forAccount:{"default":"subaccounts",get:"/accounts",put:!0,post:!0,query:!0,"delete":"/accounts"}})};


},{}],38:[function(require,module,exports){
var makeUrl=require("../util/makeurl");module.exports=function(e,r){function t(e,t){return r.request({method:"DELETE",url:makeUrl([this._config["default"],e]),data:{revoke_meters:t||!1},headers:{"Content-Type":"application/json;charset=UTF-8"}})}var o=e({forAccount:{"default":"meter_subscribers",get:!0,put:!0,post:!0,query:!0,"delete":!1}});return o._forAccount=o.forAccount,o.forAccount=function(e){var r=o._forAccount(e);return r["delete"]=t,r},o};


},{"../util/makeurl":41}],39:[function(require,module,exports){
module.exports=function(e){return e({forAccount:{"default":"tokens",get:!0,put:!0,post:!0,query:!0,"delete":!0}})};


},{}],40:[function(require,module,exports){
var makeUrl=require("./util/makeurl"),ACCOUNTS_PATH="/accounts";module.exports=function(t){function e(t){function e(){this._config=t}return t.get&&(e.prototype.get=o),t.query&&(e.prototype.query=a),(t.put||t.post)&&(e.prototype.save=n),t.batch&&(e.prototype.batchUpdate=u),t["delete"]&&(e.prototype["delete"]=c),t.forAccount&&(e.prototype.forAccount=i("accounts",t.forAccount)),t.forMeter&&(e.prototype.forMeter=i("meters",t.forMeter)),new e}function r(t,e){var r=t[e];return r===!0?t["default"]:r}function o(e,o){var n={method:"GET",url:makeUrl([r(this._config,"get"),e])};return"object"==typeof o&&angular.extend(n,o),t.request(n)}function n(e,o){var n,u,a=e;void 0===e._id&&this._config.post?(n="POST",u=r(this._config,"post")):(n="PUT",u=r(this._config,"put")+"/"+e._id,a=angular.copy(e),delete a._id);var c={method:n,url:u,data:a};return"object"==typeof o&&angular.extend(c,o),t.request(c)}function u(e,o,n){for(var u=[],a=0,c=e.length;c>a;a++){var i=angular.copy(o);i._id=e[a],u.push(i)}var f={method:"PUT",url:r(this._config,"batch"),data:u};return"object"==typeof n&&angular.extend(f,n),t.request(f)}function a(e,o){var n={method:"GET",url:r(this._config,"query"),params:f(e)};return o&&angular.extend(n,o),t.request(n)}function c(e,o){var n={method:"DELETE",url:makeUrl([r(this._config,"delete"),e])};return"object"==typeof o&&angular.extend(n,o),t.request(n)}function i(t,r){return function(o){var n=angular.copy(r);return["default","get","put","post","delete","query"].forEach(function(e){var r=n[e];"string"==typeof r&&"/"!==r[0]&&(n[e]="/"+t+"/"+o+"/"+r)}),e(n)}}function f(t){var e={};for(var r in t)if(t.hasOwnProperty(r)){var o=t[r],n=angular.isString(o);null!=o&&(n&&o.length>0||!n)&&(e[r]=o)}return e}return e};


},{"./util/makeurl":41}],41:[function(require,module,exports){
module.exports=function(r,e){r=null==r?[]:angular.isArray(r)?r:[r];for(var n=[],o=0,a=r.length;a>o;o++){var l=r[o];if(null==l)break;n.push(l.replace(/^\/|\/$/,""))}var i=n.join("/")+"?";if("object"==typeof e)for(var t in e){var u=e[t];i+=t+"="+encodeURIComponent(u)+"&"}return i.slice(0,-1)};


},{}]},{},[5]);
